*** Variables ***
${GA_KEY}         AIzaSyCFj15TpkchL4OUhLD1Q2zgxQnMb7v3XaM
${GA_DIMENSION}    rt:pagePath
${GA_METRIC}      rt:pageViews
${GA_PROFILE_ID}    ga:92833020
${GA_BEARER_TOKEN}    Bearer ya29.ywCbb0CaHOnHI6sIXy8l0AMljtLkPfdgZplv5FCVBbvu7Uw4bMv-rzOJj2y9G5kfKNdA-8waz7lLxQ
${GA_REAL_TIME_DATA_ENDPOINT}    https://content.googleapis.com
${GA_FILTERS}     rt:pagePath==/pilot/login
${GOOGLE_OAUTH_URL}    https://accounts.google.com
${GOOGLE_OAUTH_CODE}    4/Riiyc05y8zYLlWdK8ucZf_1FYJVDflXtbCvPwe6GbxQ.oot9bJHgE_EZsjMf6whcw_5VfaaqkwI
${GOOGLE_OAUTH_CLIENT_ID}    519024691571-ahkuf7ba5qpfla6971gf7duc3live6u0.apps.googleusercontent.com
${GOOGLE_OAUTH_CLIENT_SECRET}    -i47fqbeKw-orpZr6YyCIKIo
${GOOGLE_OAUTH_REDIRECT_URI}    urn:ietf:wg:oauth:2.0:oob
${GOOGLE_OAUTH_GRANT_TYPE}    authorization_code

*** Keywords ***
Page Hit Should Have Been Recorded In Google Analaytics
    [Arguments]    ${page_hit}
    Create Session    ga_realtime    ${GA_REAL_TIME_DATA_ENDPOINT}
    #URL Parameters to be passed to GA Real Time Endpoint
    ${params}=    Create Dictionary    ids    ${GA_PROFILE_ID}    metrics    ${GA_METRIC}    dimensions
    ...    ${GA_DIMENSION}
    #Headers to be passed to GA Real Time Endpoint
    ${headers}=    Create Dictionary    authorization    ${GA_BEARER_TOKEN}
    #Response recieved from ga realtime end point
    ${resp}=    Get    ga_realtime    /analytics/v3/data/realtime    params=${params}    headers=${headers}
    ${jsondata}=    To Json    ${resp.content}
    #Assertion
    Should Contain    ${resp.content}    ${page_hit}

Get Page Hit Count
    [Arguments]    ${page_hit}
    Create Session    ga_realtime    ${GA_REAL_TIME_DATA_ENDPOINT}
    #URL Parameters to be passed to GA Real Time Endpoint
    ${params}=    Create Dictionary    ids    ${GA_PROFILE_ID}    metrics    ${GA_METRIC}    dimensions
    ...    ${GA_DIMENSION}
    #Headers to be passed to GA Real Time Endpoint
    ${headers}=    Create Dictionary    authorization    ${GA_BEARER_TOKEN}
    #Response recieved from ga realtime end point
    ${resp}=    Get    ga_realtime    /analytics/v3/data/realtime?filters=rt%3ApagePath%3D%3D%2Fpilot%2Flogin    params=${params}    headers=${headers}
    # ${pageHitArray}=    Get Length    ${resp.json()['rows'][0].itemsize}
    ${jsondata}    To Json    ${resp.content}
    # Log    ${resp.json()['rows'][0][1]}

Get Bearer Token
    [Arguments]    ${code}
    Dictionary Should Contain Value    ${resp.json()['form']}
    Create Session    google_oauth    ${GOOGLE_OAUTH_URL}
    ${params}=    Create Dictionary    code    ${code}    client_id    ${GOOGLE_OAUTH_CLIENT_ID}    client_secret
    ...    ${GOOGLE_OAUTH_CLIENT_SECRET}    redirect_uri    ${GOOGLE_OAUTH_REDIRECT_URI}    grant_type    ${GOOGLE_OAUTH_GRANT_TYPE}
    ${headers}=    Create Dictionary    Content-Type    application/x-www-form-urlencoded
    ${resp}=    Post    google_oauth    /o/oauth2/token    params=${params}    headers=${headers}
    ${jsondata}    To Json    ${resp.content}
